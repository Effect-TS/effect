import * as List from "@fp-ts/data/List"

/**
 * A generator of collections of up to the specified size, where each
 * collection is generated by repeatedly applying a function to an initial
 * state.
 *
 * @tsplus static effect/core/testing/Gen.Ops unfoldGenN
 * @category constructors
 * @since 1.0.0
 */
export function unfoldGenN<S, R, A>(
  n: number,
  s: S,
  f: (s: S) => Gen<R, readonly [S, A]>
): Gen<R, List.List<A>> {
  return n <= 0 ?
    Gen.constant(List.empty()) :
    f(s).flatMap(([s, a]) => Gen.unfoldGenN(n - 1, s, f).map(List.prepend(a)))
}
