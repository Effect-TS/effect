name = "debug-demo-ai-proxy"
main = "src/index.ts"
compatibility_date = "2024-10-01"
compatibility_flags = ["nodejs_compat"]

# Account details (replace with your own)
# account_id = "your-account-id"
# workers_dev = true

# Memory and CPU limits
# Note: 128 MB memory limit is PER ISOLATE, shared across all concurrent requests
# CPU limit can be up to 5 minutes on paid plans (default varies by plan)
# [limits]
# cpu_ms = 50000  # 50 seconds (adjust based on your plan)

# Environment variables for local development
# For production, use: wrangler secret put OPENROUTER_API_KEY
[vars]
ENVIRONMENT = "development"
MAX_RESPONSE_SIZE_MB = "10"
ENABLE_DEBUG_LOGGING = "true"

# Secrets (use wrangler secret put for production)
# OPENROUTER_API_KEY = "sk-or-v1-..."
# OPENAI_API_KEY = "sk-..."

# Development configuration
[dev]
port = 8787
inspector_port = 9229
local_protocol = "http"

# Observability
[observability]
enabled = true

# Routes (for production deployment)
# routes = [
#   { pattern = "ai-proxy.example.com/*", zone_name = "example.com" }
# ]

# Tail Workers for production monitoring (optional)
# [tail_consumers]
# [[tail_consumers]]
# service = "ai-proxy-tail-logger"

# Durable Objects (if needed for rate limiting, etc.)
# [[durable_objects.bindings]]
# name = "RATE_LIMITER"
# class_name = "RateLimiter"
# script_name = "ai-proxy-rate-limiter"

# KV namespace for caching (optional, replaces in-memory cache)
# [[kv_namespaces]]
# binding = "CACHE"
# id = "your-kv-namespace-id"
# preview_id = "your-preview-kv-namespace-id"

# R2 bucket for long-term storage (optional)
# [[r2_buckets]]
# binding = "LOGS"
# bucket_name = "ai-proxy-logs"

# Analytics Engine for metrics (optional)
# [[analytics_engine_datasets]]
# binding = "ANALYTICS"

# Build configuration
[build]
command = ""
watch_dirs = ["src"]

# Production environment (optional)
# [env.production]
# name = "debug-demo-ai-proxy-production"
# vars = { ENVIRONMENT = "production", ENABLE_DEBUG_LOGGING = "false" }

# Staging environment (optional)
# [env.staging]
# name = "debug-demo-ai-proxy-staging"
# vars = { ENVIRONMENT = "staging", ENABLE_DEBUG_LOGGING = "true" }
